# ğŸ¤– Diffusion Model Meme Generator

A **Streamlit-based web application** that uses **Stable Diffusion** and **LoRA weights** to generate custom memes by combining a text-to-image prompt with user-provided overlay text.


### Main Application Interface
![Main application interface](assets/Screenshot_meme_app.png)

## ğŸ“‹ Table of Contents

* [About The Project](#ï¸-about-the-project)
* [Built With](#ï¸-built-with)
* [Getting Started](#ï¸-getting-started)

  * [Prerequisites](#prerequisites)
  * [Installation](#installation)
* [Usage](#ï¸-usage)
* [Features](#-features)
* [License & Credits](#-license--credits)
* [Acknowledgements](#-acknowledgements)

---

## â„¹ï¸ About The Project

This project is a **powerful yet easy-to-use meme generator** built with **Python** and **Streamlit**. It leverages **diffusion models** (specifically *Stable Diffusion v1.4*) enhanced with **LoRA (Low-Rank Adaptation)** weights to create high-quality, stylized images from text prompts.

The application then automatically overlays user-provided text onto the generated images, with proper styling and outlines for readability, turning any idea into a shareable meme.

---

## ğŸ› ï¸ Built With

This project utilizes several key technologies:

* **Streamlit** â€“ For the interactive web application interface.
* **Hugging Face diffusers** â€“ For the text-to-image generation pipeline.
* **PyTorch** â€“ Backend for model operations.
* **Pillow (PIL)** â€“ For image manipulation and text overlay.
* **Stable Diffusion v1.4** â€“ The base diffusion model.
* **rschroll/maya_model_v1_lora** â€“ LoRA weights for stylistic fine-tuning.

---

## ğŸš€ Getting Started

Follow these steps to set up the project locally.

### Prerequisites

* Python 3.8 or newer
* pip (Python package installer)
* A **CUDA-enabled GPU** (recommended for faster performance; CPU mode supported but slower)
* The `arial.ttf` font file (standard on Windows/macOS; on Linux, install via `sudo apt-get install ttf-mscorefonts-installer` or update the font path in code)

### Installation

1. **Clone the repository:**

   ```bash
   git clone https://github.com/Otto-Destiny/meme-generator-with-stable-diffusion-model.git
   cd your-project-directory
   ```

2. **Create and activate a virtual environment:**

   ```bash
   python -m venv venv
   source venv/bin/activate  # On Windows, use `venv\Scripts\activate`
   ```

3. **Install dependencies:**

   ```bash
   pip install streamlit torch diffusers transformers Pillow safetensors
   ```

   > Note: `transformers` and `safetensors` are required for the diffusers pipeline.

---

## ğŸ–¥ï¸ Usage

Run the Streamlit app from your terminal:

```bash
streamlit run app.py
```

Your default browser will open automatically (usually at [http://localhost:8501](http://localhost:8501)).

### App Controls

* **Number of Images:** Select how many meme variants to generate (1â€“10).
* **Text-to-Image Prompt:** Describe your background image (e.g., *"A confused golden retriever looking at a laptop"*).
* **Text to Display:** Enter your meme text (e.g., *"WHAT IS CODE?"*).

Click **Generate Images** and wait for the model to do its magic!

> The first run will take longer as models and weights are downloaded. Thanks to Streamlitâ€™s `@st.cache_resource`, subsequent generations will be much faster.

Your generated memes will appear on the main page, ready to save and share.

---

## âœ¨ Features

* **Simple Streamlit UI** â€“ Clean and responsive.
* **Advanced Image Generation** â€“ Combines Stable Diffusion + LoRA for enhanced visuals.
* **Automatic Text Overlay** â€“ Adds outlined text for readability.
* **Batch Generation** â€“ Create up to 10 memes at once.
* **Smart Caching** â€“ Model loads only once per session.
* **Hardware Agnostic** â€“ Uses GPU if available; falls back to CPU.

---

## ğŸ“œ License & Credits

This project is presented as part of coursework for **WorldQuant University**.
It is covered by WorldQuant Universityâ€™s academic and licensing policies. These may restrict sharing, redistribution, or commercial use. Please treat this repository as an **educational and portfolio example only**.

The project code and framework are licensed under the **Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License**.

To view a copy of this license, visit:
[http://creativecommons.org/licenses/by-nc-nd/4.0/](http://creativecommons.org/licenses/by-nc-nd/4.0/)

---

## ğŸ™ Acknowledgements

* **WorldQuant University** â€“ For the educational program and project structure.
* **Hugging Face** â€“ For the `diffusers` library and hosting of models.
* **Stable Diffusion creators** â€“ For the foundational model.
* **rschroll** â€“ For the `maya_model_v1_lora` LoRA weights.

---
